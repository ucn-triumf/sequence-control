<!DOCTYPE html>
<html class="mcss">
<head>
   <meta charset="UTF-8">
   <link rel="stylesheet" href="midas.css">
   <script src="controls.js"></script>
   <script src="midas.js"></script>
   <script src="mhttpd.js"></script>
   <title>Sequencer</title>
   <style>
    .aParent div {
      float: left;
      clear: none; 
    }

    /* Left / right columns based on this page:
       https://www.w3schools.com/html/tryit.asp?filename=tryhtml_layout_float
       */

    leftcolumn {
      float: left;
      width: 40%;
      padding: 5px;
    }


    rightcolumn {
      float: left;
      padding: 5px;
      width: 40%;
    }

    doublecolumn {
      float: left;
      padding: 5px;
      width: 80%;
    }

    /* Clear floats after the columns */
    section:after {
      content: "";
      display: table;
      clear: both;
    }

   </style>
   <script>
   gShowLife = false;
   function show_life(){      
      if(gShowLife){
         gShowLife = false;
         document.getElementById("life_button").value = "Show Lifetime Parameters";
         document.getElementById("lifetime_div").style.display = "none";
      }else{
         gShowLife = true;
         document.getElementById("life_button").value = "Hide Lifetime Parameters";          
         document.getElementById("lifetime_div").style.display = "block";
      }
   }
   gShowFull = false;
   function show_full(){      
      if(gShowFull){
         gShowFull = false;
         document.getElementById("full_button").value = "Show Full Set Parameters";
         document.getElementById("full_div").style.display = "none";
      }else{
         gShowFull = true;
         document.getElementById("full_button").value = "Hide Full Set Parameters";          
         document.getElementById("full_div").style.display = "block";
      }
   }

   function load_simple(){      
      var rad_time  = document.getElementById("irradiation_time").value;
      var open_time = document.getElementById("iv1_open_time").value;

      // To do: disable the sequencer (if enabled), set all parameters in one big
      // call, then re-enable the sequencer (if it was originally enabled...)
      // need to zero out all settings first... that should be a standard call...
      // even have a button for that standard call.
      alert(salert);

   }


   function set_tables(){

      // Period Duration Time Table
      
      var DurationTableText = '<table class="mtable" ><tr> <td></td><th colspan="20" class="mtableheader">Period Duration Times (Seconds)</th> ';
      DurationTableText +='<th colspan="8" class="mtableheader">Valve State</th>';
      DurationTableText +='<tr> <td> </td> <td colspan="20" style="text-align: center;">Cycles</td> <td colspan="8" style="text-align: center;">Valve #</td></tr><tr><td></td>';
      var i, j;
      for(i = 0; i < 20; i++){
         DurationTableText += '<td style="width: 30px;text-align: center;"> ' + i +' </td>';
      }
      for(i = 0; i < 8; i++){
         DurationTableText += '<td style="width: 30px;text-align: center;"> ' + i +' </td>';
      }
      DurationTableText += '</tr>'

      for(i = 0; i < 10; i++){
         var period = i + 1;
         DurationTableText += '<tr>'
         DurationTableText += '<td style="width: 100px;"> Period ' + period + '</td>';
         for(j = 0; j < 20; j++){

            DurationTableText += "<td style=''width: 30px; text-align: center;'> <div  name='modbvalue' data-odb-path='/Equipment/UCNSequencer2018/Settings/DurationTimePeriod" + period + "["+j+"]' data-odb-editable='1' ></div> </td>"
         }


         for(j = 0; j < 8; j++){
            var valve = j+1;
            DurationTableText += "<td style=''width: 30px; text-align: center;'> <input type='checkbox' name='modbcheckbox' data-odb-path='/Equipment/UCNSequencer2018/Settings/Valve"+valve+"State["+i+"]'></input></td>";
         }
         DurationTableText += '</tr>'
         
         
      }

      DurationTableText += '</table>';

      document.getElementById("DurationTable").innerHTML = DurationTableText;

   }
   </script>

</head>



<body class="mcss" onload="set_tables();mhttpd_init('Sequencer');">

<!-- header and side navigation will be filled in mhttpd_start -->
<div id="mheader"></div>
<div id="msidenav"></div>

<div id="mmain">

  <section>
    <leftcolumn>
      <table class="mtable">
        <tr>
          <th colspan="2" class="mtableheader">Basic Sequencer Parameters</th>
        </tr>
        <tr>
          <td style="width: 200px;">
            Enable:
          </td>
          <td style="width: 300px;">       
            <input type="checkbox" name="modbcheckbox" data-odb-path="/Equipment/UCNSequencer2018/Settings/enable"></input>
          </td>
        </tr>
        <tr>
          <td>
            Irradiation Time:
          </td>
          <td>       
            <input id="irradiation_time"></input>
          </td>
        </tr>
        <tr>
          <td>
            IV1 Open Time:
          </td>
          <td>       
            <input id="iv1_open_time"></input>
          </td>
        </tr>

        <tr>
          <td>
           
          </td>
          <td>       
            <input type="button" id="load_simple_button" onclick="load_simple()" value="Load Sequence" ></input>
          </td>
        </tr>
        <tr>
          <td style="width: 200px;">
            <input type="button" id="life_button" onclick="show_life();" value="Show Lifetime Parameters" ></input>
          </td>
          <td >       
            <input type="button" id="full_button" onclick="show_full();" value="Show Full Set Parameters" ></input>
          </td>
        </tr>
      </table>
    </leftcolumn>
  
    
    <rightcolumn id="lifetime_div" style="display:none">
      <table class="mtable">
        <tr>
          <th colspan="2" class="mtableheader">Setup Lifetime Sequence</th>
        </tr>
      </table>
      
    </rightcolumn>
  </section>
  <div>
  </div>
  <hr>
  

  <div id="full_div" style="display:none">


    
    <section>
      <leftcolumn>
        <table class="mtable">
          <tr>
            <th colspan="2" class="mtableheader">Sequence Scale Settings</th>
          </tr>
          <tr>
            <td style="width: 300px;">
              # Periods in Cycle:
            </td>
            <td style="width: 200px;">       
              <div  name="modbvalue" data-odb-path="/Equipment/UCNSequencer2018/Settings/numberPeriodsInCycle" data-odb-editable="1" ></div> 
            </td>
          </tr>
          <tr>
            <td style="width: 300px;">
              # Cycles in Super-Cycle:
            </td>
            <td style="width: 200px;">       
              <div  name="modbvalue" data-odb-path="/Equipment/UCNSequencer2018/Settings/numCyclesInSuper" data-odb-editable="1" ></div> 
            </td>
          </tr>
        </table>
      </leftcolumn>
      
      <rightcolumn>
        <table class="mtable">
          <tr>
            <th colspan="2" class="mtableheader">Configuration Notes</th>
          </tr>
          <tr>
            <td style="width: 200px;">
              Note 1:
            </td>
            <td style="">       
              Valve 1 is IV1 (UCN Valve)
            </td>
          </tr>
        </table>
        
      </rightcolumn>
      
    </section>
    
    
    <section>
      <doublecolumn>
        <div id ="DurationTable">
          
        </div>
      </doublecolumn>
      
    </section>

  </div>
  
</body>
</html>
